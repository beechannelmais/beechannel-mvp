'use client';
import Nav from '@/components/Nav'; import { useSearchParams } from 'next/navigation'; import { listProfiles } from '@/lib/profiles'; import type { Profile } from '@/lib/types'; import { CATALOG, categories } from '@/lib/catalog'; import VideoCard from '@/components/VideoCard'; import { getWatchLater } from '@/lib/watchlater'; import { getProgress } from '@/lib/progress';
export default function CatalogPage(){ const params=useSearchParams(); const profileId=params.get('profile'); const profile:Profile|null=profileId?(listProfiles().find(p=>p.id===profileId)||null):null; const wl=profile?new Set(getWatchLater(profile)):new Set<string>(); const progress=profile?getProgress(profile):{}; const contWatching=CATALOG.filter(v=>progress[v.id]&&progress[v.id]>5); return (<main><Nav/><div className="container py-6 space-y-8"><div className="flex items-center justify-between"><h1 className="text-2xl font-bold">Vitrine</h1>{profile&&<span className="text-white/70">Perfil: {profile.name} {profile.avatar}</span>}</div>{profile&&contWatching.length>0&&(<section><h2 className="text-xl font-semibold mb-3">Continuar assistindo</h2><div className="grid sm:grid-cols-2 md:grid-cols-3 gap-4">{contWatching.map(v=><VideoCard key={v.id} v={v}/>)}</div></section>)}{profile&&wl.size>0&&(<section><h2 className="text-xl font-semibold mb-3">Assistir mais tarde</h2><div className="grid sm:grid-cols-2 md:grid-cols-3 gap-4">{CATALOG.filter(v=>wl.has(v.id)).map(v=><VideoCard key={v.id} v={v}/>)}</div></section>)}{categories().map(cat=>(<section key={cat}><h2 className="text-xl font-semibold mb-3">{cat}</h2><div className="grid sm:grid-cols-2 md:grid-cols-3 gap-4">{CATALOG.filter(v=>v.category===cat).map(v=><VideoCard key={v.id} v={v}/>)}</div></section>))}</div></main>);}
